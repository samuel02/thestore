<div class="page-header">
  <h1>Welcome to The Store!</h1>
</div>

<div class="row">
  <div class="span8 products-display">
    <div class="row">
      <% @products.each_with_index do |product, index| %>
        <div class="span4">
          <h3><%= product.name %> <small><%= number_to_currency(product.price) %></small></h3>
          <% unless product.image_url.nil? %>
            <img src="<%= product.image_url %>">
          <% end %>
          <p><%= truncate product.description %></p>
          <div class="form-actions">
            <a class="btn">More info</a>

            <%= link_to "Add to cart", line_items_path(:product_id => product), :method => 'post', :class => "btn btn-primary" %>
          </div>
        </div>
      <% end %>
    </div>
  </div>
  <div class="span4 sidebar">
    <div class="well">
      <h3 style="margin-top:0px">Cart</h3>
      <% if @cart.line_items.size > 0 %>
        <table class="table table-striped table-condensed">
          <tr>
            <th>Product</th>
            <th>Amount</th>
            <th>Price</th>
          </tr>
          <% @cart.line_items.each do |line_item| %>
            <tr>
              <td><%= line_item.product.name %></td>
              <td><%= line_item.amount %></td>
              <td><%= number_to_currency(line_item.price) %></td>
            </tr>
          <% end %>
          <tr>
            <td></td>
            <td><strong>Total</strong></td>
            <td><%= number_to_currency(@cart.total_price) %></td>
          </tr>
        </table>
        <hr>
        <div style="padding-bottom:15px">
          <%= link_to raw("<i class=\"icon-remove\"></i> Empty cart"),
                      '/empty_cart',
                      class: "btn btn-danger" %>
          <%= link_to raw("<i class=\"icon-shopping-cart\"></i> Checkout"),
                      new_order_path,
                      class: "btn btn-success" %>
        </div>
      <% else %>
        <p>No products in cart, add a product!</p>
      <% end %>
    </div>
  </div>
</div>
